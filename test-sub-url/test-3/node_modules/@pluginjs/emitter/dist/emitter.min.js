!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e["@pluginjs/emitter"]={})}(this,function(e){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(){function e(){n(this,e),this.listeners={},this.sortedListeners={}}return r(e,[{key:"emit",value:function(e){for(var t=this.getListeners(e),n=arguments.length,r=Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];for(var i=0;i<t.length;i++){var o=null;if(o=null!==t[i].context?t[i].context:{type:e},!1===t[i].listener.apply(o,r))return!1}return!0}},{key:"on",value:function(e,t,n,r){return this.addListener(e,t,n,r)}},{key:"once",value:function(e,t,n,r){return this.addOneTimeListener(e,t,n,r)}},{key:"off",value:function(e,t){return void 0===t?this.removeAllListeners(e):this.removeListener(e,t)}},{key:"addListener",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return this.ensureListener(t),this.listeners[e]||(this.listeners[e]={}),this.listeners[e][r]||(this.listeners[e][r]=[]),this.listeners[e][r].push({context:n,listener:t}),this.clearSortedListeners(e),this}},{key:"addOneTimeListener",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,s=this;return this.addListener(e,function n(){return s.removeListener(e,n),t.apply(void 0,arguments)},n,r),this}},{key:"removeListener",value:function(e,t){this.clearSortedListeners(e);var n=this.hasListeners(e)?this.listeners[e]:[];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(n[r]=n[r].filter(function(e){return e.listener!==t}),0===n[r].length&&delete n[r]);return this.listeners[e]=n,this}},{key:"removeAllListeners",value:function(e){return this.clearSortedListeners(e),this.hasListeners(e)&&delete this.listeners[e],this}},{key:"ensureListener",value:function(e){var n=void 0===e?"undefined":t(e);if("function"===n)return e;throw new TypeError("Listeners should be function or closure. Received type: "+n)}},{key:"hasListeners",value:function(e){return!(!this.listeners[e]||0===Object.keys(this.listeners[e]).length)}},{key:"getListeners",value:function(e){return this.sortedListeners.hasOwnProperty(e)||(this.sortedListeners[e]=this.getSortedListeners(e)),this.sortedListeners[e]}},{key:"getSortedListeners",value:function(e){if(!this.hasListeners(e))return[];var t=this.listeners[e],n=Object.keys(t);n.sort(function(e,t){return e-t});for(var r=[],s=0;s<n.length;s++)r=r.concat(t[n[s]]);return r}},{key:"clearSortedListeners",value:function(e){delete this.sortedListeners[e]}}]),e}();e.default=s,Object.defineProperty(e,"__esModule",{value:!0})});
